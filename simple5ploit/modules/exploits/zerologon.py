from .internal.base import Exploit

class ZeroLogon(Exploit):
    def __init__(self):
        super().__init__()
        self.prompt = "[ZeroLogon] -> "
        self.pip_dependencies = [
            "cffi==1.14.2",
            "click==7.1.2",
            "cryptography==3.1",
            "dnspython==2.0.0",
            "Flask==1.1.2",
            "future==0.18.2",
            "impacket==0.9.21",
            "itsdangerous==1.1.0",
            "Jinja2==2.11.2",
            "ldap3==2.8",
            "ldapdomaindump==0.9.3",
            "MarkupSafe==1.1.1",
            "pyasn1==0.4.8",
            "pycparser==2.20",
            "pycryptodomex==3.9.8",
            "pyOpenSSL==19.1.0",
            "six==1.15.0",
            "Werkzeug==1.0.1"
        ] 

        self.args = {
            "dc_name":
                { "description": "domain controller name",
                    "required": True },
            "dc_ip": 
                { "description": "domain controller IP",
                    "required": True },
            "user":
                { "description": "",
                    "required": False }
        }

        for arg in self.args.keys():
            self.__dict__[arg] = "N/a"

    def run(self):
        pass
